# SSL

## ุฃููุงู ุจูุ ุฎุทูุงุช ุชุซุจูุช ุดูุงุฏุฉ Let's Encrypt Wildcard SSL (ูุชุบุทูุฉ ุฌููุน ุงููุทุงูุงุช ุงููุฑุนูุฉ) ุนูู ุฎุงุฏูู ุงูุฎุงุต (ุจุงูุชุฑุงุถ ุฃูู ูุนูู ุจูุธุงู Linux ูุซู Debian) ุชุชุทูุจ ุงุณุชุฎุฏุงู ุฃุฏุงุฉ Certbot ูุทุฑููุฉ ุงูุชุญูู ุนุจุฑ DNS Challenge.

## ูุธุฑูุง ูุฃูู ุชุณุชุฎุฏู Hostinger ูุฅุฏุงุฑุฉ DNSุ ูุฌุจ ุฃู ุชููู ูุฐู ูู ุงูุฎุทูุงุช:

## ูุชุทูุจุงุช ุฃุณุงุณูุฉ
ุงููุตูู ุฅูู ุงูุฎุงุฏู: ูุฌุจ ุฃู ุชููู ูุงุฏุฑูุง ุนูู ุงูุงุชุตุงู ุจุงูุฎุงุฏู ุงูุฎุงุต ุจู ุนุจุฑ SSH (ูุซู ssh go@ip).

ุฃุฏุงุฉ Certbot: ูุฌุจ ุชุซุจูุช ุฃุฏุงุฉ certbot ุนูู ุฎุงุฏูู.

ุฅุถุงูุฉ API Token (ุฃุณูู ุทุฑููุฉ): ูุธุฑูุง ูุฃู Hostinger ุชุฏุนู ุงูุชูุงูู ุนุจุฑ APIุ ูุฅู ุงุณุชุฎุฏุงู ุฅุถุงูุฉ Certbot ุงูุฎุงุตุฉ ุจู Hostinger ูู ุฃุณูู ุทุฑููุฉ ูุฅุฏุงุฑุฉ ุงูุชุญุฏู ุชููุงุฆููุง.

## ุงูุฎุทูุงุช ุงูุชูุตูููุฉ (ุจุงุณุชุฎุฏุงู Certbot ู DNS Challenge)
1. ุชุซุจูุช Certbot ูุงููููู ุงูุฅุถุงูู ูู Hostinger (ุนูู ุฎุงุฏูู)
ุฃููุงูุ ุชุฃูุฏ ูู ุชุซุจูุช Certbot ูุงูุฅุถุงูุฉ ุงููุงุฒูุฉ ููุชุญูู ูู DNS ุนุจุฑ Hostinger.

### ุชุญุฏูุซ ูุงุฆูุฉ ุงูุญุฒู
```bash
sudo apt update
# ุชุซุจูุช Certbot (ุฅุฐุง ูู ููู ูุซุจุชุงู)
sudo apt install certbot python3-certbot-dns-hostinger

```

### ุงูุญุตูู ุนูู ุฑูุฒ API (API Token) ูู Hostinger
ุชุญุชุงุฌ ุฅูู ุงูุญุตูู ุนูู ุฑูุฒ ูุตูู (Token) ูุณูุญ ูู Certbot ุจุชุญุฏูุซ ุณุฌูุงุช DNS ูุคูุชูุง ูุฅุซุจุงุช ููููุชู:

ุณุฌู ุงูุฏุฎูู ุฅูู ุญุณุงุจู ูู Hostinger.

ุงุจุญุซ ุนู ุฅุนุฏุงุฏุงุช API ุฃู Developers.

ูู ุจุฅูุดุงุก New API Token (ุฑูุฒ API ุฌุฏูุฏ) ูุชุฃูุฏ ูู ููุญู ุตูุงุญูุงุช ุฅุฏุงุฑุฉ DNS.

ุงุญุชูุธ ุจูุฐุง ุงูุฑูุฒ ุณุฑูุงู.


### ุฅุนุฏุงุฏ ููู ุจูุงูุงุช ุงูุงุนุชูุงุฏ (Credentials File)
ูู ุจุฅูุดุงุก ููู ูุตู ุขูู ุนูู ุฎุงุฏูู ูุญุชูู ุนูู ุฑูุฒ API ุงูุฐู ุญุตูุช ุนููู. ูุฐุง ุงูููู ูุฌุจ ุฃู ูููู ูุญููุงู ูููุฑูุกุงู ููุท ูู ูุจู ุงููุณุชุฎุฏู ุงูุฌุฐุฑ (Root) ุฃู ุงููุณุชุฎุฏู ุงูุฐู ูููู ุจุชุดุบูู Certbot.

```bash
sudo mkdir -p /etc/letsencrypt
sudo nano /etc/letsencrypt/hostinger-credentials.ini
# ุฏุงุฎู ุงููููุ ุฃุถู ุงูุณุทุฑ ุงูุชุงููุ ูุณุชุจุฏูุงู YOUR_HOSTINGER_API_TOKEN ุจุงูุฑูุฒ ุงูุฐู ุญุตูุช ุนููู:
dns_hostinger_api_token = YOUR_HOSTINGER_API_TOKEN
# ุญูุธ ุงูููู   ุจุงูุงู ูุงุนุทุงุก ุงูุตูุงุญูุงุช ุงูููุงุณุจุฉ
sudo chmod 600 /etc/letsencrypt/hostinger-credentials.ini

```


### ุชุซุจูุช ุดูุงุฏุฉ SSL
```bash
sudo certbot certonly --dns-hostinger \
  --dns-hostinger-credentials /etc/letsencrypt/hostinger-credentials.ini \
  -d osmbeta.cloud -d *.osmbeta.cloud
```

ุดุฑุญ ุงูุฃูุฑ:

certonly: ูุทูุจ ุงูุดูุงุฏุฉ ููุท (ูุง ูููู ุจุชุซุจูุชูุง ุชููุงุฆูุงู ุนูู ุฎุงุฏู ุงูููุจ).

--dns-hostinger: ูุญุฏุฏ ุงุณุชุฎุฏุงู ุงูุฅุถุงูุฉ ุงูุฎุงุตุฉ ุจู Hostinger ููุชุญูู ูู DNS.

--dns-hostinger-credentials ...: ูุดูุฑ ุฅูู ููู ุจูุงูุงุช ุงูุงุนุชูุงุฏ.

-d osmbeta.cloud -d *.osmbeta.cloud: ูุญุฏุฏ ุฃู ุงูุดูุงุฏุฉ ูุฌุจ ุฃู ุชุบุทู ููุงู ูู ุงูุฏูููู ุงูุฑุฆูุณู ูุงููุทุงู ุงููุฑุนู ุงูุดุงูู.

ูุงุฐุง ุณูุญุฏุซุ ุณูููู Certbot ุจู:

ุงุณุชุฎุฏุงู ุฑูุฒ API ููุงุชุตุงู ุจู Hostinger.

ุฅุถุงูุฉ ุณุฌูุงุช TXT ุงููุงุฒูุฉ ููุชุญูู ูู ููููุฉ ุงููุทุงู.

ุงูุงูุชุธุงุฑ ุญุชู ููุชูู ุงูุชุญูู.

ุฅุตุฏุงุฑ ุงูุดูุงุฏุฉ ูุญูุธูุง ูู ุงููุณุงุฑ /etc/letsencrypt/live/osmbeta.cloud/.



. ุชุซุจูุช ุงูุดูุงุฏุฉ ูุชูููู ุฎุงุฏู ุงูููุจ
ุจุนุฏ ุงูุญุตูู ุนูู ุงูุดูุงุฏุฉุ ูุฌุจ ุนููู ุชุนุฏูู ูููุงุช ุชูููู ุฎุงุฏู ุงูููุจ ุงูุฎุงุต ุจู (ูุซู Apache ุฃู Nginx) ููุฅุดุงุฑุฉ ุฅูู ูููุงุช ุงูุดูุงุฏุฉ ุงูุฌุฏูุฏุฉ:

ูุณุงุฑ ุงูุดูุงุฏุฉ ุงููุงููุฉ (Full Chain): /etc/letsencrypt/live/osmbeta.cloud/fullchain.pem

ูุณุงุฑ ุงูููุชุงุญ ุงูุฎุงุต (Private Key): /etc/letsencrypt/live/osmbeta.cloud/privkey.pem

ูู ุจุชุญุฏูุซ ูููุงุช ุงูู Virtual Host ูู ุฎุงุฏู ุงูููุจ ูุชุณุชุฎุฏู ูุฐู ุงููุณุงุฑุงุช.

6. ุฅุนุฏุงุฏ ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู (Auto-Renewal)
ุดูุงุฏุงุช Let's Encrypt ุตุงูุญุฉ ููุฏุฉ 90 ููููุง ููุท. ูุฌุจ ุนููู ุฅุนุฏุงุฏ ูููุฉ Cron ุฃู Timer ูุชุดุบูู ุฃูุฑ ุงูุชุฌุฏูุฏ ุชููุงุฆููุง




## ุงูุชุซุจูุช ูู ุฎูุงู ุจูุฆูุฉ venv

```bash
sudo apt install python3-venv

# ุงูุงูุชูุงู ุฅูู ูุฌูุฏ Certbot (ุฃู ุฃู ูุฌูุฏ ุขูู)
cd /opt

# ุฅูุดุงุก ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ ุจุงุณู "certbot-venv"
sudo python3 -m venv certbot-venv

# ุชูุนูู ุงูุจูุฆุฉ (ููุฏุฎูู ุฅูููุง)
# ููุงุญุธุฉ: ุณูุญุชุงุฌ ุฅูู ุชูููุฐ ูุฐุง ุงูุฃูุฑ ูู ูู ูุฑุฉ ูุฑูุฏ ูููุง ุงุณุชุฎุฏุงู ุงูุฅุถุงูุฉ
source /opt/certbot-venv/bin/activate
pip install certbot-dns-hostinger


# ูุณุชุฎุฏู ุงููุณุงุฑ ุงููุงูู ูููู certbot
# this is 
sudo /opt/certbot-venv/bin/certbot certonly \
  --authenticator dns-hostinger \
  --dns-hostinger-credentials /etc/letsencrypt/hostinger-credentials.ini \
  -d osmbeta.cloud -d *.osmbeta.cloud

# or use this
sudo /opt/certbot-venv/bin/certbot certonly \
  --authenticator dns-hostinger \
  --dns-hostinger-credentials /etc/letsencrypt/hostinger-credentials.ini \
  --dns-hostinger-propagation-seconds 90 \
  -d osmbeta.cloud -d *.osmbeta.cloud
deactivate
```

### notes
ูุฏูุง ุชููู ุจุฅุนุฏุงุฏ ุงูุชุฌุฏูุฏ ุงูุชููุงุฆู ูู Certbotุ ูุฌุจ ุนููู ุงูุชุฃูุฏ ูู ุฃู ูููุฉ ุงูุชุฌุฏูุฏ (Cron Job ุฃู Systemd Timer) ุชุณุชุฎุฏู ุฃูุถุงู ุงููุณุงุฑ ุงููุงูู ููุฃูุฑ ุฏุงุฎู ุงูุจูุฆุฉ ุงูุงูุชุฑุงุถูุฉ (/opt/certbot-venv/bin/certbot) ููู ูุนูู ุงูุชุฌุฏูุฏ ุจุดูู ุตุญูุญ ูู 90 ูููู



## ุชุซุจูุช ุงูุดูุงุฏุฉ ุนูู nginx

- 1. โ๏ธ ุชุญุฏูุฏ ูููุน ูููุงุช ุงูุดูุงุฏุฉ
ูููุงุช ุงูุดูุงุฏุฉ ุงูุชู ุชุญุชุงุฌ ุฅูููุง ูู:
```bash
# ููู ุงูุดูุงุฏุฉ ุงููุงููุฉ (Certificate/Fullchain):
/etc/letsencrypt/live/osmbeta.cloud/fullchain.pem
# ููู ุงูููุชุงุญ ุงูุฎุงุต (Private Key):

/etc/letsencrypt/live/osmbeta.cloud/privkey.pem
```



- 2. ๐ ุชูููู nginx
- . ุฅูุดุงุก ููู ุงูุชูููู ุงูุฑุฆูุณู (Server Block)
ุณูููู ุจุฅูุดุงุก ููู ุชูููู ุฌุฏูุฏ ููู ุชุทุจููุ ููุถุญ ูู Nginx ุฃูู ูุฌุฏ ูุฐุง ุงูุชุทุจูู.

ูููุชุฑุถ ุฃู ูุฏูู ุชุทุจูููู:

ุงูุชุทุจูู ุงูุฃูู (ุงููุงุฌูุฉ ุงูุฃูุงููุฉ): ูุนูู ุนูู ุงููุทุงู ุงููุฑุนู app1.osmbeta.cloud.

ุงูุชุทุจูู ุงูุซุงูู (ุงููุงุฌูุฉ ุงูุฃูุงููุฉ): ูุนูู ุนูู ุงููุทุงู ุงููุฑุนู app2.osmbeta.cloud.

ูุซุงู ูุชูููู ุงูุชุทุจูู ุงูุฃูู (app1.osmbeta.conf)
ุฃูุดุฆ ุงูููู ูู ุงููุณุงุฑ ุงูููุงุณุจ (ูุซูุงู: /etc/nginx/sites-available/app1.conf):

## create file
sudo nano /etc/nginx/sites-available/app.conf

## add this content


## ุชูููู nginx example
```bash 

# ูู ุจุฅุนุงุฏุฉ ุชูุฌูู HTTP ุฅูู HTTPS ุฃููุงู
server {
    listen 80;
    server_name app1.osmbeta.cloud;
    return 301 https://$host$request_uri;
}

# ุชูููู HTTPS
server {
    listen 443 ssl;
    server_name summary.osmbeta.cloud; # ููุง ุชุญุฏุฏ ุงููุทุงู ุงููุฑุนู ููุฐุง ุงูุชุทุจูู

    # --- ูุณุงุฑุงุช ุดูุงุฏุฉ Wildcard SSL ---
    ssl_certificate /etc/letsencrypt/live/osmbeta.cloud/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/osmbeta.cloud/privkey.pem;

    # --- ุงูุชูุฌูู ุฅูู ุญุงููุฉ Docker (Backend ุฃู Frontend) ---
    location / {
        # ุงูุชุฑุถ ุฃู ุญุงููุฉ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (Next.js/React) ููุชุทุจูู ุงูุฃูู ุชุนูู ุนูู ูููุฐ 3001
        proxy_pass http://localhost:3001; 
        
        # ุฅุนุฏุงุฏุงุช Header ุงูููุงุณูุฉ
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-Proto $scheme;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
    
    # ูุซุงู ูุชูุฌูู ูุณุงุฑ API ูุนูู ุฅูู ุญุงููุฉ Django/Gunicorn
    location /api/ {
        # ุงูุชุฑุถ ุฃู ุญุงููุฉ Django/Gunicorn ููุชุทุจูู ุงูุฃูู ุชุนูู ุนูู ูููุฐ 8001
        proxy_pass http://localhost:8001/api/; 
    }
}

```

๐ ููุงุญุธุงุช ูุงูุฉ ุญูู ุญุงููุงุช Docker
ูุชูุฌุญ ูุฐู ุงูุจููุฉุ ูุฌุจ ูุฑุงุนุงุฉ ูุง ููู ุนูุฏ ุชุดุบูู ุญุงููุงุชู:

ุชุนููู ุงูููุงูุฐ (Ports): ูุฌุจ ุฃู ุชุถูู ุฃู ูู ุญุงููุฉ ุชุทุจูู (ุงููุงุฌูุฉ ุงูุฃูุงููุฉ ุฃู ุงูุฎูููุฉ) ุชุณุชุฎุฏู ูููุฐุงู ูุฑูุฏุงู ุนูู ุงูุฎุงุฏู ุงูุฃุณุงุณู (Host Server). ูู ุงููุซุงู ุฃุนูุงูุ ุงุณุชุฎุฏููุง 3001 ูููุงุฌูุฉ ุงูุฃูุงููุฉ ู 8001 ููุฎูููุฉ ุงูุฎุงุตุฉ ุจู app1.

ุงูุงุชุตุงู ุจุงูู Proxy: ูุฌุจ ุฃู ูุชู ุฑุจุท ุงููููุฐ ุงูุฏุงุฎูู ููุญุงููุฉ ุจุงููููุฐ ุงูููุฌู ูู Nginx. ุนูุฏ ุชุดุบูู ุญุงููุฉ Dockerุ ูุฌุจ ุฃู ุชููู ุงูููุงูุฐ ูุฑุฆูุฉ ูู localhost (ุฃู 127.0.0.1) ุญุชู ูุชููู Nginx ูู ุงููุตูู ุฅูููุง.

ูุซุงู: ุนูุฏ ุชุดุบูู ุญุงููุฉ Next.js ุงูุฎุงุตุฉ ุจู app1 (ุงูุชู ุชุณุชูุน ุฏุงุฎููุงู ุนูู 3000)ุ ูุฌุจ ุฑุจุทูุง ุนูู ุงููุญู ุงูุชุงูู:



ูุฑุจุท ููู ุงูุชูููู ุจูุธุงู Nginxุ ูู ุจุฅูุดุงุก ุฑุงุจุท ุฑูุฒู (Symlink) ูุชุฃูุฏ ูู ุฃู Nginx ูุงุฏุฑ ุนูู ุชุญูููู:

```bash
# ุฅูุดุงุก ุฑุงุจุท ุฑูุฒู
sudo ln -s /etc/nginx/sites-available/app1.conf /etc/nginx/sites-enabled/app1.conf

# (ูุฑุฑ ุงูุฎุทูุฉ ูู app2.conf ุฅุฐุง ููุช ุจุฅูุดุงุฆู)

# ุงุฎุชุจุงุฑ ุงูุชูููู
sudo nginx -t

# ุฅุนุงุฏุฉ ุชุดุบูู Nginx ูุชุทุจูู ุงูุชุบููุฑุงุช
sudo systemctl restart nginx
```





```bash
# ุชุญูู ูู ุตุญุฉ ุชูููู nginx
sudo nginx -t
# ุฅุนุงุฏุฉ ุชุดุบูู nginx
sudo systemctl restart nginx
```